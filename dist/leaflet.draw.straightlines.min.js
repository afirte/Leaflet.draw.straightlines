!function(){function n(n){var t;return e.eachLayer(function(o){o instanceof n&&(t=o)}),t}function t(n){var t=Math.abs(n.lat-l.lat),o=Math.abs(n.lng-l.lng);return o>t}var o,a,l,e,r,g=L.Draw.Polyline.prototype._onMouseMove,i=L.Draw.Polyline.prototype._onMouseUp;window.onkeydown=function(n){a=n.ctrlKey},window.onkeyup=function(){a=!1},L.Draw.Polyline.prototype._onMouseMove=function(n){if(g.call(this,n),e=n.target,e.on("draw:drawstop",function(){l=null}),a&&o){var r=e.latLngToLayerPoint(o.getLatLng());t(n.latlng)?(o.setLatLng(L.latLng(l.lat,o.getLatLng().lng)),n.layerPoint.y=r.y):(o.setLatLng(L.latLng(o.getLatLng().lat,l.lng)),n.layerPoint.x=r.x),this._updateGuide(n.layerPoint),o.update()}},L.Draw.Polyline.prototype._onMouseUp=function(e){i.call(this,e);var g=n(L.Polyline);if(o=n(L.Marker),o.on("mousedown",function(){r=!0,console.log("clicked a marker")}),r)return void(r=!1);if(a){var u=g.getLatLngs();l&&u.length&&(t(e.latlng)?(u[u.length-1].lat=l.lat,u[u.length-2].lat=l.lat):(u[u.length-1].lng=l.lng,u[u.length-2].lng=l.lng),g.redraw())}l=o.getLatLng()}}();